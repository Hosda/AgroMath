<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa</title>
    <link rel="stylesheet" href="/CSS/containt.css">
    <link rel="stylesheet" href="/CSS/map.css">
</head>
<body>
    
    <div id="iframe-container">
        <iframe id="iframe" src="ol_map.html"></iframe>
    </div>
    <p></p>
    <div class="comentario" style="text-align: center;">
        <h1 class="title" >Sua área:</h1>
        <p id="m" style="padding-left: 2%;">Selecione seu terreno no mapa primeiro</p>
        <p id="km" style="padding-left: 2%;"></p>
        <p id="ha" style="padding-left: 2%;"></p>
        
        <div id="button" style="display: none;" class="button" onclick="buttonOnClick()"> Calcular receita! </div>
    </div>
    
    <script>
        window.onload = function() {
            
            const iframe = document.getElementById("iframe");
            const areaM = document.getElementById("m");
            const areaKM = document.getElementById("km");
            const areaHA = document.getElementById("ha");
            const button = document.getElementById("button");
            
            if (!localStorage.getItem("theme")) {
                localStorage.setItem("theme", "white");
            }
            var theme = localStorage.getItem("theme");

            function changeTheme() {
                if (theme == "dark") {
                    document.documentElement.style.setProperty('--cabecalho', '#161616');
                    document.documentElement.style.setProperty('--principal', '#222222');
                    document.documentElement.style.setProperty('--secundario', '#363636');
                    document.documentElement.style.setProperty('--texto', '#ffffff');
                }
                if (theme == "white") {
                    document.documentElement.style.setProperty('--cabecalho', '#cecece');
                    document.documentElement.style.setProperty('--principal', '#888888');
                    document.documentElement.style.setProperty('--secundario', '#bbbbbb');
                    document.documentElement.style.setProperty('--texto', '#000000');
                }
            }
            changeTheme();
            
            function checkIframe() {

                if (iframe && iframe.contentWindow.area) {
                    var area = iframe.contentWindow.area;
                    areaHA.innerText = (area / 10000).toFixed(2) + " Hectares(ha)";
                    areaKM.innerText = (area / 1000000).toFixed(2) + " Quilômetros quadrados (km²)";
                    areaM.innerText = (area).toFixed(0) + " Metros quadrados (m²)";
                    localStorage.setItem("area", (area / 10000).toFixed(2));
                    button.style.display = "block";
                }
            }

            setInterval(checkIframe, 100);
        }
        function buttonOnClick() {
            localStorage.setItem("page", "Pages/custos.html");
            window.parent.location.reload();
        }
    </script>
</body>

</html>